#!/bin/bash

echo "Author:Patrick Gray aka. ToxicScript"

if [ -z "$1" ]
then
	echo "Usage ./nmap.sh <ip address>"
	exit 1
fi
testconnection=$(ping $1 -c 1 | grep "64 bytes")

if [ -z ${#testconnection} ]
then
	echo $testconnection
	echo $1 " is down"
	exit 1
fi
printf "\n $1 is up \n"
printf "\n----NMAP----\n\n" > results
printf "\n Running Nmap..."
ports=$(nmap -p 1-65535 --min-rate=1000 -T4 $1 | grep ^[0-9] | cut -d '/' -f 1 | tr '\n' ',' | sed s/,$//)
nmap -sC -sV -sS -A -p-$ports $1 >> results
printf "\n\n Printing Results \n\n"
cat results
printf "\n Possible Exploits \n"
checkexploits=$(cat results | grep "open" | cut -d " " -f 14,15)
printf "\n searching for exploits for $1 \n\n"
searchsploit $checkexploits
