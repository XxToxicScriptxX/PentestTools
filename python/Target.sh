#!/bin/bash


function gather_info_domain
{
	target=$name
	echo "									####	     IP using DIG		#####"
	string=$target;
	prefix="https://";
	string=${string#$prefix}; #Remove prefix
	dig +short $string
	echo "									#####     NMAP	Testing all possible ports #####"
	nmap -p 1-65535 $target -v | grep "Discovered open port"
	echo ""
	echo ""
	echo "									##### testing for alive webserver  #####"
	if curl -I "$target"; then
		echo "$target alive and web site is up"
	else
		echo "$target offline or web server problem"
	fi
	echo "									##### testing for SSH  #####"
	if ssh "$target" true; then
		echo "$target alive and accessible via SSH"
	else
		echo "$target offline or not accepting SSH logins"
	fi
	echo "									##### testing for alive MYSQL  #####"
	if ssh "$target" bash -c 'ps aux | grep -q mysqld'; then
		echo "$target alive and running MySQL"
	else
		echo "$target offline or MySQL not present"
	fi
	echo "=========================================================================================================================================================================================================="
	echo ""
	echo ""
	echo ""
	echo ""
	echo ""
	echo ""
}


do
    name=$1
    echo  $name
    gather_info_domain
    
done < $1
